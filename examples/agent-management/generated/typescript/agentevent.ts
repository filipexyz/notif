/**
 * Generated by schem - DO NOT EDIT
 * Schema: AgentEvent v1.0.0
 */

export interface AgentEventError {
  message?: string;
  code?: string;
}

export interface AgentEventPr {
  url?: string;
  number?: number;
}

export interface AgentEvent {
  /** Session identifier */
  sessionId: string;
  /** Agent name that emitted this event */
  agent: string;
  /** Event type */
  kind: 'started' | 'progress' | 'output' | 'completed' | 'failed' | 'blocked';
  /** Human-readable progress message */
  message?: string;
  /** Final result summary (for completed) */
  result?: string;
  /** Error details (for failed) */
  error?: AgentEventError;
  /** PR info if created (for completed) */
  pr?: AgentEventPr;
  /** Cost incurred so far */
  costUsd?: number;
  timestamp: string;
}

export const AgentEventSchema = {
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "agentevent.schema.json",
  "title": "AgentEvent",
  "type": "object",
  "properties": {
    "sessionId": {
      "type": "string",
      "description": "Session identifier"
    },
    "agent": {
      "type": "string",
      "description": "Agent name that emitted this event"
    },
    "kind": {
      "type": "string",
      "enum": [
        "started",
        "progress",
        "output",
        "completed",
        "failed",
        "blocked"
      ],
      "description": "Event type"
    },
    "message": {
      "type": "string",
      "description": "Human-readable progress message"
    },
    "result": {
      "type": "string",
      "description": "Final result summary (for completed)"
    },
    "error": {
      "type": "object",
      "description": "Error details (for failed)",
      "properties": {
        "message": {
          "type": "string"
        },
        "code": {
          "type": "string"
        }
      }
    },
    "pr": {
      "type": "object",
      "description": "PR info if created (for completed)",
      "properties": {
        "url": {
          "type": "string"
        },
        "number": {
          "type": "integer"
        }
      }
    },
    "costUsd": {
      "type": "number",
      "description": "Cost incurred so far"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    }
  },
  "required": [
    "sessionId",
    "agent",
    "kind",
    "timestamp"
  ],
  "description": "Event emitted by an agent (progress, completion, errors)"
} as const;

/**
 * Validate data against the AgentEvent schema
 * @throws Error if validation fails
 */
export function validateAgentEvent(data: unknown): AgentEvent {
  if (typeof data !== 'object' || data === null) {
    throw new Error('Expected an object');
  }

  const obj = data as Record<string, unknown>;

  if (obj['sessionId'] === undefined) {
    throw new Error('Missing required field: sessionId');
  }
  if (obj['agent'] === undefined) {
    throw new Error('Missing required field: agent');
  }
  if (obj['kind'] === undefined) {
    throw new Error('Missing required field: kind');
  }
  if (obj['timestamp'] === undefined) {
    throw new Error('Missing required field: timestamp');
  }

  return data as AgentEvent;
}
