/**
 * Generated by schem - DO NOT EDIT
 * Schema: AgentMessage v1.0.0
 */

export interface AgentMessageOptions {
  /** Max spend for this session */
  budgetUsd?: number;
  /** Session timeout */
  timeoutSeconds?: number;
  /** Auto-create PR on completion */
  autoPr?: boolean;
}

export interface AgentMessage {
  /** Session identifier for tracking */
  sessionId: string;
  /** Target agent name */
  agent: string;
  /** Message type */
  kind: 'prompt' | 'resume' | 'cancel';
  /** The prompt/instruction to send (for prompt/resume) */
  prompt?: string;
  options?: AgentMessageOptions;
}

export const AgentMessageSchema = {
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "agentmessage.schema.json",
  "title": "AgentMessage",
  "type": "object",
  "properties": {
    "sessionId": {
      "type": "string",
      "description": "Session identifier for tracking"
    },
    "agent": {
      "type": "string",
      "description": "Target agent name"
    },
    "kind": {
      "type": "string",
      "enum": [
        "prompt",
        "resume",
        "cancel"
      ],
      "description": "Message type"
    },
    "prompt": {
      "type": "string",
      "description": "The prompt/instruction to send (for prompt/resume)"
    },
    "options": {
      "type": "object",
      "properties": {
        "budgetUsd": {
          "type": "number",
          "description": "Max spend for this session"
        },
        "timeoutSeconds": {
          "type": "integer",
          "description": "Session timeout"
        },
        "autoPr": {
          "type": "boolean",
          "description": "Auto-create PR on completion"
        }
      }
    }
  },
  "required": [
    "sessionId",
    "agent",
    "kind"
  ],
  "description": "Message sent to control an agent (prompt, cancel, etc.)"
} as const;

/**
 * Validate data against the AgentMessage schema
 * @throws Error if validation fails
 */
export function validateAgentMessage(data: unknown): AgentMessage {
  if (typeof data !== 'object' || data === null) {
    throw new Error('Expected an object');
  }

  const obj = data as Record<string, unknown>;

  if (obj['sessionId'] === undefined) {
    throw new Error('Missing required field: sessionId');
  }
  if (obj['agent'] === undefined) {
    throw new Error('Missing required field: agent');
  }
  if (obj['kind'] === undefined) {
    throw new Error('Missing required field: kind');
  }

  return data as AgentMessage;
}
