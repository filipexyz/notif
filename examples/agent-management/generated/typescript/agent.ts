/**
 * Generated by schem - DO NOT EDIT
 * Schema: Agent v1.0.0
 */

export interface AgentExecutor {
  /** The executor type */
  kind?: 'claude' | 'codex' | 'gemini' | 'custom';
  /** Model or CLI version */
  version?: string;
  /** Command to invoke (e.g., "claude") */
  cli?: string;
}

export interface AgentProject {
  name?: string;
  /** Working directory */
  path?: string;
  /** Git repo (e.g., "filipexyz/notif") */
  repo?: string;
}

export interface Agent {
  /** Unique agent name (e.g., "coder-1", "researcher") */
  name: string;
  /** What this agent does */
  description?: string;
  /** Machine hostname where agent is running */
  hostname?: string;
  /** Capabilities/skills tags (e.g., ["typescript", "react"]) */
  tags?: string[];
  executor?: AgentExecutor;
  project?: AgentProject;
  /** Current agent status */
  status?: 'idle' | 'busy' | 'offline';
  /** Currently running session ID if busy */
  activeSessionId?: string;
}

export const AgentSchema = {
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "agent.schema.json",
  "title": "Agent",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "description": "Unique agent name (e.g., \"coder-1\", \"researcher\")"
    },
    "description": {
      "type": "string",
      "description": "What this agent does"
    },
    "hostname": {
      "type": "string",
      "description": "Machine hostname where agent is running"
    },
    "tags": {
      "type": "array",
      "description": "Capabilities/skills tags (e.g., [\"typescript\", \"react\"])",
      "items": {
        "type": "string"
      }
    },
    "executor": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "claude",
            "codex",
            "gemini",
            "custom"
          ],
          "description": "The executor type"
        },
        "version": {
          "type": "string",
          "description": "Model or CLI version"
        },
        "cli": {
          "type": "string",
          "description": "Command to invoke (e.g., \"claude\")"
        }
      }
    },
    "project": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "path": {
          "type": "string",
          "description": "Working directory"
        },
        "repo": {
          "type": "string",
          "description": "Git repo (e.g., \"filipexyz/notif\")"
        }
      }
    },
    "status": {
      "type": "string",
      "enum": [
        "idle",
        "busy",
        "offline"
      ],
      "description": "Current agent status",
      "default": "idle"
    },
    "activeSessionId": {
      "type": "string",
      "description": "Currently running session ID if busy"
    }
  },
  "required": [
    "name"
  ],
  "description": "An agent that can be discovered and controlled remotely"
} as const;

/**
 * Validate data against the Agent schema
 * @throws Error if validation fails
 */
export function validateAgent(data: unknown): Agent {
  if (typeof data !== 'object' || data === null) {
    throw new Error('Expected an object');
  }

  const obj = data as Record<string, unknown>;

  if (obj['name'] === undefined) {
    throw new Error('Missing required field: name');
  }

  return data as Agent;
}
